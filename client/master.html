<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>master</title>
    <link href="favicon.ico" rel="icon" type="image/ico" />
    <script type="text/javascript" src="clock.js"></script>
    <script type="text/javascript" src="player.js"></script>
    <script type="text/javascript" src="syncer.js"></script>
    <script type="text/javascript" src="master.js"></script>
    <script>
      /*
       * when you click on header element:
       *  socket and player will be instantiated.
       *
       *  when socket connects syncer will start to communicate with server for
       *  a clock synchronization and if it succeeds it will bind socket message
       *  event to a player.
       *
       *  player and streamer on server will continue to communicate.
       */
      window.addEventListener('load', function() {
        var did = false;
        var header = document.getElementById("header");
        header.addEventListener('click', function() {
          if (did) {return;}
          var socket = new WebSocket("ws://lieutier.me:8080");
          header.innerHTML = "syncing...";
          socket.onopen = function() {
            new Syncer(socket, function() {
              header.innerHTML = "master synced!";
              did = true;
              new Master(socket);
            });
          };
        });
      }, false);
    </script>
  </head>
  <body>
    <h1 id="header">master. click here to start.</h1>
  </body>
</html>
