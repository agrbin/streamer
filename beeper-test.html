<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html style="height: 90%">
  <head>
    <script type="text/javascript" src="config.js"></script>
    <script type="text/javascript" src="beeper.js"></script>
    <script>
      window.AudioContext =
        window.AudioContext ||
        window.webkitAudioContext;

      what = navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ?
        'touchstart' : 'mousedown';

      var inited = false;

      window.addEventListener(what, function() {
        if (inited) return;
        //try {
        var body = document.getElementsByTagName("BODY")[0],
          ctx = new AudioContext(),
          gui = {
            log : function (msg) {console.log(msg);},
            toggleBlink : function () {
              inBeep ^= 1;
              body.style.backgroundColor = inBeep ? 'white' : 'black';
            }
          },
          beeper = new Beeper(ctx, gui),
          beep = function (e) {
            e.preventDefault();
            console.log('sent beep');
            beeper.beep(config);
            return false;
          },
          inBeep = false;

        inited = true;
        console.log('start');
        body.addEventListener(what, beep, false);
        //} catch (err) { alert(err); }
      }, false);
    </script>
  </head>
  <body style="height: 100%; background-color: black;">
  </body>
</html>
